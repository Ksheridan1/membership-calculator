<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exterior Service Membership Calculator</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.5/dist/signature_pad.umd.min.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background:#f3f6fb;
  padding:20px;
}
.calculator {
  max-width:900px;
  margin:auto;
  background:#fff;
  padding:25px;
  border-radius:12px;
  box-shadow:0 10px 25px rgba(0,0,0,0.1);
}
.grid {
  display:grid;
  gap:12px;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
}
input, select {
  padding:8px;
  border:1px solid #ccc;
  border-radius:6px;
}
button {
  margin-top:15px;
  padding:10px;
  width:100%;
  background:#0f766e;
  color:white;
  border:none;
  border-radius:8px;
  font-weight:bold;
  cursor:pointer;
}
.results {
  margin-top:20px;
  padding:15px;
  background:#f8fbff;
  border-radius:8px;
  display:none;
}
canvas {
  border:1px solid #ccc;
  border-radius:6px;
  margin-top:10px;
  width:100%;
  height:200px;
}
</style>
</head>

<body>
<div class="calculator">

<h2>Membership Calculator + Contract</h2>

<div class="grid">

<input id="clientName" placeholder="Client Full Name">
<input id="clientAddress" placeholder="Client Address">

<select id="activationFee">
<option value="100">Activation – $100</option>
<option value="199">Activation – $199</option>
<option value="299">Activation – $299</option>
</select>

<input id="softWash" placeholder="Soft Wash Price" type="number">
<input id="gutterFeet" placeholder="Gutter Feet" type="number">
<input id="gutterRate" placeholder="Gutter Rate" type="number">
<input id="windowCount" placeholder="Window Count" type="number">
<input id="windowRate" placeholder="Window Rate" type="number">
<input id="drivewayPrice" placeholder="Driveway Price" type="number">

</div>

<button onclick="calculate()">Calculate</button>

<div class="results" id="results">
<p><strong>Annual Retail:</strong> <span id="annualRetail"></span></p>
<p><strong>Membership Monthly:</strong> <span id="memberMonthly"></span></p>
<p><strong>Activation Due Today:</strong> <span id="activationDisplay"></span></p>
</div>

<h3>Client Signature</h3>
<canvas id="signaturePad"></canvas>
<button onclick="clearSignature()">Clear Signature</button>

<button onclick="generatePDF()">Generate Contract PDF</button>

</div>

<script>
const { jsPDF } = window.jspdf;
const canvas = document.getElementById("signaturePad");
const signaturePad = new SignaturePad(canvas);

function resizeCanvas() {
  const ratio = Math.max(window.devicePixelRatio || 1, 1);
  canvas.width = canvas.offsetWidth * ratio;
  canvas.height = 200 * ratio;
  canvas.getContext("2d").scale(ratio, ratio);
}
resizeCanvas();

function get(id){
  return parseFloat(document.getElementById(id).value) || 0;
}

function currency(val){
  return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(val);
}

function calculate(){

  const annual =
    get("softWash") +
    get("gutterFeet") * get("gutterRate") +
    get("windowCount") * get("windowRate") +
    get("drivewayPrice");

  const monthly = (annual / 12) * 0.85;
  const activation = get("activationFee");

  document.getElementById("annualRetail").textContent = currency(annual);
  document.getElementById("memberMonthly").textContent = currency(monthly);
  document.getElementById("activationDisplay").textContent = currency(activation);
  document.getElementById("results").style.display = "block";
}

function clearSignature(){
  signaturePad.clear();
}

function generatePDF(){

  if(signaturePad.isEmpty()){
    alert("Please capture client signature first.");
    return;
  }

  const doc = new jsPDF();

  const name = document.getElementById("clientName").value;
  const address = document.getElementById("clientAddress").value;
  const activation = get("activationFee");
  const annual = document.getElementById("annualRetail").textContent;
  const monthly = document.getElementById("memberMonthly").textContent;

  doc.setFontSize(12);
  doc.text("12-Month Exterior Service Membership Agreement", 20, 20);
  doc.text("Client: " + name, 20, 35);
  doc.text("Address: " + address, 20, 45);

  doc.text("Annual Retail Value: " + annual, 20, 60);
  doc.text("Membership Monthly Payment: " + monthly, 20, 70);
  doc.text("Activation Fee Due Today: " + currency(activation), 20, 80);

  doc.text("Term: 12 Months (Auto-Renewal Unless Cancelled in Writing)", 20, 95);

  doc.text("Client agrees to a 12-month subscription term.", 20, 110);
  doc.text("Early cancellation requires payment of remaining balance.", 20, 120);
  doc.text("Activation fee is non-refundable.", 20, 130);

  const signatureImage = signaturePad.toDataURL("image/png");
  doc.addImage(signatureImage, "PNG", 20, 150, 60, 30);

  doc.text("Client Signature", 20, 145);

  doc.save(name + "_Membership_Contract.pdf");
}
</script>

</body>
</html>


